# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  ScreenActivityFinalizeAndSend:
    Properties:
      BackgroundImage: ='uvv-clouds'
      Fill: =RGBA(0, 0, 0, 0)
      Height: |-
        =//Max(App.Height; App.MinScreenHeight)
        Max(App.Height, App.DesignHeight)
      ImagePosition: =ImagePosition.Fill
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      Width: |-
        =//Max(App.Width; App.MinScreenWidth)
        Max(App.Width, App.DesignWidth)
    Children:
      - MainContainer1_4:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            DropShadow: =DropShadow.None
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width
            X: =
            Y: =
          Children:
            - Header1_4:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  BorderColor: =RGBA(0, 0, 0, 0)
                  BorderStyle: =BorderStyle.None
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =88
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutMinHeight: =40
                  LayoutMinWidth: =Parent.Width-15
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: =Parent.Width
                Children:
                  - HeaderLabel1_4:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(255, 255, 255, 1)
                        ContentLanguage: =Language()
                        FillPortions: =1
                        Font: =Font.'Open Sans'
                        Height: =Parent.Height
                        LayoutMinWidth: =1
                        OnSelect: =
                        PaddingLeft: =15
                        Size: =MyFontSize+5
                        Text: =LookUp(colLanguage,Title="Finalize & send activity").Wert
                        Tooltip: =" "
                        Width: =
                        X: =
                        Y: =
                  - Back1_4:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =
                        LayoutMinWidth: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =90
                        X: =
                        Y: =
                      Children:
                        - BackIcon1_4:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              AccessibleLabel: =Self.Tooltip
                              BorderColor: =RGBA(0, 0, 0, 0)
                              BorderStyle: =BorderStyle.None
                              Color: =RGBA(255, 255, 255, 1)
                              ContentLanguage: =Language()
                              DisabledFill: =RGBA(39, 113, 194, 1)
                              FocusedBorderColor: =RGBA(9, 33, 98, 1)
                              Height: =60
                              HoverBorderColor: =ColorFade(RGBA(9, 33, 98, 1), 20%)
                              HoverFill: =RGBA(39, 113, 194, 1)
                              Icon: =Icon.ArrowLeft
                              OnSelect: =Navigate(ScreenActivity);
                              PressedBorderColor: =ColorFade(RGBA(9, 33, 98, 1), 20%)
                              PressedFill: =RGBA(39, 113, 194, 1)
                              TabIndex: =0
                              Tooltip: =BackLabel1_4.Text
                              Width: =60
                              X: =15
                              Y: =15
                        - BackLabel1_4:
                            Control: FluentV8/Label@1.8.6
                            Properties:
                              Alignment: =Align.Center
                              Color: =RGBA(255, 255, 255, 1)
                              ContentLanguage: =Language()
                              DisplayMode: =DisplayMode.View
                              Font: =Font.'Patrick Hand'
                              FontSize: =MyFontSize-4
                              Height: =30
                              Text: =LookUp(colLanguage,Title="Back").Wert
                              Tooltip: =" "
                              VerticalAlignment: =VerticalAlign.Middle
                              Visible: =BackIcon1_4.Visible
                              Width: =90
                              X: |+
                                =BackIcon1_4.X+BackIcon1_4.Width/2-Self.Width/2
                              Y: =58
            - Body1_4:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.Start
                  BorderColor: =RGBA(0, 0, 0, 0)
                  BorderStyle: =BorderStyle.None
                  DropShadow: =DropShadow.None
                  Height: =88
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutMinHeight: =40
                  LayoutMinWidth: =Parent.Width-15
                  PaddingLeft: =10
                  PaddingRight: =10
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: =Parent.Width
                Children:
                  - ContainerEdit1_4:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Start
                        BorderThickness: =2
                        DropShadow: =DropShadow.None
                        Fill: |-
                          =RGBA(241, 244, 249, 1)
                          //RGBA(244; 244; 243; 1)
                        FillPortions: =0
                        Height: |+
                          =Parent.Height
                          -Parent.PaddingTop
                          -Parent.PaddingBottom
                        LayoutMinHeight: =If(Self.Visible,Parent.Height-15,0)
                        LayoutMinWidth: =1
                        RadiusBottomLeft: =30
                        RadiusBottomRight: =30
                        RadiusTopLeft: =30
                        RadiusTopRight: =30
                        Width: |+
                          =Parent.Width-Self.X*2
                        X: =19+1
                        Y: =20
                      Children:
                        - SaveGroupButton1_4:
                            Control: Classic/Button@2.2.0
                            Group: SaveGroup1_14
                            Properties:
                              BorderThickness: =0
                              Color: =RGBA(255,255,255,1)
                              ContentLanguage: =Language()
                              DisplayMode: =If(OnlineStatus=1,DisplayMode.Edit,DisplayMode.Disabled)
                              Fill: =RGBA(56, 96, 178, 1)
                              Height: =60
                              HoverBorderColor: =
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =RGBA(9, 33, 98, 1)
                              OnSelect: "=Set (ShowDeleteDialog,false);\r\nSet(_ShowLoadingHint,true);\r\n//--------------------------------------------------\r\nUpdateContext({locInputCheck:true});\r\n//--------------------------------------------------\r\n//Check: CheckpointText available for all checkpoints?\r\nIf(LookUp(SComponents,Pos>0 && IsBlank(CheckpointText),Pos) > 0,\r\n    UpdateContext({locInputCheck:false});\r\n    Notify(\"Checkpoint text is blank for an entry\");\r\n);\r\n//--------------------------------------------------\r\n//Check: Status available for all required checkpoints?\r\nIf(LookUp(\r\n    SComponents,\r\n    Pos>0 && Required && IsBlank(Status),\r\n    Pos) >0,\r\n    UpdateContext({locInputCheck:false});\r\n    Notify(\"Checkpoint status is blank for a required entry\");\r\n);\r\n//--------------------------------------------------\r\n//Check: Flex fields answered for required entries?\r\nIf(LookUp(SComponents,\r\n    Pos > 0 && Required &&\r\n    (\r\n        (!IsBlank(F1Label) && IsBlank(F1))||\r\n        (!IsBlank(F2Label) && IsBlank(F2))||\r\n        (!IsBlank(F3Label) && IsBlank(F3))||\r\n        (!IsBlank(F4Label) && IsBlank(F4))||\r\n        (!IsBlank(F5Label) && IsBlank(F5))\r\n    ),\r\n    Pos)>0,\r\n    UpdateContext({locInputCheck:false});\r\n    Notify(\"Field is blank for a required entry\");\r\n);\r\n//--------------------------------------------------\r\nIf(locInputCheck, \r\n    \r\n    Patch(MyActivities, \r\n        LookUp(MyActivities,ID=SelectedActivity),\r\n        {\r\n            DocumentStatus:\"New\",\r\n            Comments:SActivityComments\r\n        }\r\n    );    \r\n\r\n    If(!IsEmpty(Errors([@MyActivities])),\r\n        Set(locErrorCode,\r\n            \"Error! Could not save the entry!\"\r\n        );\r\n        Notify(\r\n            locErrorCode,\r\n            //LookUp(MyUVVSettings;\r\n            //Title=\"Fehler beim Speichern!\").Wert;\r\n            NotificationType.Error, \r\n            2000\r\n        );\r\n    , //Else\r\n        Set(locErrorCode,\"\");\r\n    );\r\n\r\n    If(IsBlank(locErrorCode) && MyDeviceType=\"Mobile\",\r\n        SaveData(MyActivities,\"Activities\")\r\n    );\r\n\r\n);\r\n//--------------------------------------------------\r\n//Save activity in SP list\r\nIf(locInputCheck && IsBlank(locError) && OnlineStatus=1,\r\n\r\n    //Set(_ShowSendingHint;true);;   \r\n    Set(FooterText,\"Sending activity to SharePoint\");\r\n    Set(SendDataText,SendDataText &\"<br>\"&FooterText);    \r\n\r\n    //Search for the activity in the SharPoint list\r\n    Refresh(pssChecklistsActivities);\r\n    Set(locID,\r\n        LookUp(pssChecklistsActivities,KEY=SActivityKEY,ID)\r\n    );\r\n    Set(PatchID,\r\n        Patch(pssChecklistsActivities,\r\n        If(locID>0,\r\n            LookUp(pssChecklistsActivities,KEY=SActivityKEY),\r\n            Defaults(pssChecklistsActivities)\r\n        ),\r\n        {\r\n            KEY:SActivityKEY,\r\n            DocumentStatus:\"New\",\r\n            Titel:SActivityTitle,\r\n            ChecklistText:SActivityChecklistText,\r\n            Date:SActivityDate,\r\n            User:SActivityUser,\r\n            UserEMail:SActivityUserEMail,\r\n            Comments:SActivityComments,\r\n            LanguageTag:Left(Language(),2)\r\n        }\r\n        ).ID\r\n    );\r\n    If(!IsEmpty(Errors([@pssChecklistsActivities])),\r\n        Set(locErrorCode,\"Error! Could not save the entry!\");\r\n        Notify(\r\n            locErrorCode,\r\n            //LookUp(MyUVVSettings;\r\n            //Title=\"Fehler beim Speichern!\").Wert;\r\n            NotificationType.Error, \r\n            2000\r\n        );\r\n    , //Else\r\n        Set(locErrorCode,\"\");\r\n    );\r\n\r\n);\r\n//--------------------------------------------------\r\n//Save activity checkpoints in SP list\r\nIf(locInputCheck && IsBlank(locError) && OnlineStatus=1,\r\n\r\n    Set(FooterText,\"Sending activity checkpoints data\");\r\n    Set(SendDataText,SendDataText &\"<br>\"&FooterText);    \r\n\r\n    Refresh(pssChecklistsActivitiesP);\r\n    Clear(B);\r\n    ForAll(Filter(MyActivitiesP,KEY=SActivityKEY) As aSource, \r\n\r\n        Notify(\r\n            \"Sending checkpoint data\"\r\n            //LookUp(MyUVVSettings;\r\n            //Title=\"Sending checkpoint data\").Wert \r\n            &\": \"\r\n            &\"Pos=\"&aSource.Pos,\r\n            NotificationType.Information,\r\n            500\r\n        );    \r\n\r\n        If(LookUp(pssChecklistsActivitiesP,\r\n            KEY=aSource.KEY && Pos=aSource.Pos,\r\n            ID)>0,\r\n\r\n            // gefunden\r\n            Patch(pssChecklistsActivitiesP,\r\n                LookUp(pssChecklistsActivitiesP,\r\n                KEY=aSource.KEY && Pos=aSource.Pos),\r\n                {\r\n                    ParentID:PatchID,\r\n                    Titel:SActivityTitle, \r\n                    KEY:aSource.KEY,\r\n                    Pos:aSource.Pos,\r\n                    Checkpoint:aSource.Checkpoint,\r\n                    CheckpointText:aSource.CheckpointText,\r\n                    Status:aSource.Status,\r\n                    StatusText:aSource.StatusText,\r\n                    DefectClass:aSource.DefectClass,\r\n                    Comments:aSource.Comments,\r\n                    F1:aSource.F1,\r\n                    F2:aSource.F2,\r\n                    F3:aSource.F3,\r\n                    F4:aSource.F4,\r\n                    F5:aSource.F5,\r\n                    F1Title:aSource.F1Title,\r\n                    F2Title:aSource.F2Title,\r\n                    F3Title:aSource.F3Title,\r\n                    F4Title:aSource.F4Title,\r\n                    F5Title:aSource.F5Title,\r\n                    F1Label:aSource.F1Label,\r\n                    F2Label:aSource.F2Label,\r\n                    F3Label:aSource.F3Label,\r\n                    F4Label:aSource.F4Label,\r\n                    F5Label:aSource.F5Label\r\n                }\r\n            );\r\n            If(IsBlankOrError(pssChecklistsActivitiesP),\r\n                Collect(B,\r\n                {\r\n                    Pos:aSource.Pos,\r\n                    KEY:aSource.KEY,\r\n                    OK:\"not OK\"\r\n                })\r\n            ,//Else\r\n                Collect(B,\r\n                {\r\n                    Pos:aSource.Pos,\r\n                    KEY:aSource.KEY,\r\n                    OK:\"OK\"\r\n                })\r\n            )\r\n            \r\n        ,//Else\r\n\r\n            //nicht gefunden\r\n            Patch(pssChecklistsActivitiesP,\r\n                Defaults(pssChecklistsActivitiesP),\r\n                {\r\n                    ParentID:PatchID,\r\n                    Titel:SActivityTitle, \r\n                    KEY:aSource.KEY,\r\n                    Pos:aSource.Pos,\r\n                    Checkpoint:aSource.Checkpoint,\r\n                    CheckpointText:aSource.CheckpointText,\r\n                    Status:aSource.Status,\r\n                    StatusText:aSource.StatusText,\r\n                    DefectClass:aSource.DefectClass,\r\n                    Comments:aSource.Comments,\r\n                    F1:aSource.F1,\r\n                    F2:aSource.F2,\r\n                    F3:aSource.F3,\r\n                    F4:aSource.F4,\r\n                    F5:aSource.F5,\r\n                    F1Title:aSource.F1Title,\r\n                    F2Title:aSource.F2Title,\r\n                    F3Title:aSource.F3Title,\r\n                    F4Title:aSource.F4Title,\r\n                    F5Title:aSource.F5Title,\r\n                    F1Label:aSource.F1Label,\r\n                    F2Label:aSource.F2Label,\r\n                    F3Label:aSource.F3Label,\r\n                    F4Label:aSource.F4Label,\r\n                    F5Label:aSource.F5Label\r\n                }\r\n            );\r\n            If(IsBlankOrError(pssChecklistsActivitiesP),\r\n                Collect(B,\r\n                {\r\n                    Pos:aSource.Pos,\r\n                    KEY:aSource.KEY,\r\n                    OK:\"not OK\"\r\n                })\r\n            ,//Else\r\n                Collect(B,\r\n                {\r\n                    Pos:aSource.Pos,\r\n                    KEY:aSource.KEY,\r\n                    OK:\"OK\"\r\n                })\r\n            )\r\n\r\n        )\r\n    );\r\n\r\n    UpdateContext({\r\n        CountMyActivitiesPLocal:\r\n        CountIf(MyActivitiesP,KEY=SActivityKEY)\r\n    });\r\n    UpdateContext({CountMyActivitiesPRemote:CountIf(B,OK=\"OK\")});\r\n    If(CountMyActivitiesPLocal<>CountMyActivitiesPRemote,\r\n        Set(locError,\"Error\");\r\n        Notify (\r\n            \"Activity checkpoints\"\r\n            //LookUp(MyUVVSettings;\r\n            //Title=\"UVV Komponenten\").Wert\r\n            &\": \"\r\n\r\n            &\"Error while sending to SharePoint\"\r\n            //&LookUp(MyUVVSettings;\r\n            //Title=\"Daten wurde nicht korrekt gesendet\").Wert\r\n            &\". \" \r\n            \r\n            &\"Records to send\"\r\n            //&LookUp(MyUVVSettings;Title=\"Datensätze zu senden\").Wert\r\n            &\": \" \r\n            &CountMyActivitiesPLocal \r\n            & \" \" \r\n            \r\n            &\"Records sent correctly\"\r\n            //&LookUp(MyUVVSettings;\r\n            //Title=\"Korrekt an SharePoint übertragen\").Wert\r\n            &\": \" \r\n            &CountMyActivitiesPRemote \r\n        )\r\n    )\r\n);\r\n//------------------------------------------------------------- \r\n//If all good, change DocumentStatus \r\nIf(locInputCheck && IsBlank(locError) && OnlineStatus=1,\r\n\r\n    Set(FooterText,\"Activity sent successfully\");\r\n    Set(SendDataText,SendDataText &\"<br>\"&FooterText);    \r\n    \r\n    Patch(pssChecklistsActivities,\r\n        LookUp(pssChecklistsActivities,KEY=SActivityKEY),\r\n        {\r\n            DocumentStatus:\"Sent\"\r\n        }\r\n    );\r\n\r\n    //If(IsBlankOrError(pssChecklistsActivities);\r\n    If(!IsEmpty(Errors([@pssChecklistsActivities])),\r\n        Set(locErrorCode,\"Error! Could not send the activity\");\r\n        Notify(\r\n            locErrorCode,\r\n            //LookUp(MyUVVSettings;\r\n            //Title=\"Fehler beim Speichern!\").Wert;\r\n            NotificationType.Error, \r\n            2000\r\n        );\r\n    , //Else\r\n        Set(locErrorCode,\"\");\r\n    );\r\n);\r\n//------------------------------------------------------------   \r\nIf(locInputCheck && IsBlank(locError) && OnlineStatus=1,\r\n\r\n    // Alles war ok\r\n    Set(FooterText,\"Deleting activity locally\");\r\n    Set(SendDataText,SendDataText &\"<br>\"&FooterText);    \r\n\r\n    RemoveIf(MyActivities,ID=SelectedActivity);\r\n    If(MyDeviceType=\"Mobile\",\r\n        If(CountRows(MyActivities)=0,\r\n            ClearData(\"Activities\")\r\n        ,//Else\r\n            SaveData(MyActivities,\"Activities\");  \r\n        )\r\n    );\r\n\r\n    Set(FooterText,\"Deleting activty checkpoints locally\");\r\n    Set(SendDataText,SendDataText &\"<br>\"&FooterText);    \r\n    ForAll(B As aSource,\r\n        If(aSource.OK=\"OK\",\r\n            RemoveIf(MyActivitiesP,\r\n                KEY=aSource.KEY && Pos=aSource.Pos\r\n            )\r\n        )\r\n    );\r\n    Clear(B);\r\n    If(MyDeviceType=\"Mobile\",\r\n        If(CountRows(MyActivitiesP)=0,\r\n            ClearData(\"ActivitiesP\")\r\n        ,//Else\r\n            SaveData(MyActivitiesP,\"ActivitiesP\");  \r\n        );\r\n    );\r\n);\r\n//--------------------------------------------------\r\nSet(_ShowLoadingHint,false);\r\nSet(_ShowSendingHint,false);\r\nSet(FooterText,\"\");\r\nSet(SendDataText,\"\");\r\n//--------------------------------------------------\r\n//Daten neu einlesen\r\nIf(locInputCheck && IsBlank(locErrorCode), \r\n    Set(InitialReadActivities,true);\r\n    //Set(ReadActivities;true);;    \r\n    Navigate(StartScreen);\r\n);\r\n"
                              PaddingLeft: =45
                              PressedBorderColor: =
                              PressedColor: =RGBA(255, 255, 255, 1)
                              PressedFill: =RGBA(9, 33, 98, 1)
                              Size: =MyFontSize-3
                              Text: =LookUp(colLanguage,Title="Send").Wert
                              Tooltip: =Self.Text
                              Width: =Parent.Width/2
                              X: =Parent.Width/2-Self.Width/2
                              Y: =Parent.Height-Self.Height-15
                        - SaveGroupIcon1_4:
                            Control: Classic/Icon@2.5.0
                            Group: SaveGroup1_14
                            Properties:
                              AccessibleLabel: =Self.Tooltip
                              Color: =RGBA(255, 255, 255, 1)
                              ContentLanguage: =Language()
                              DisplayMode: =If(OnlineStatus=1,DisplayMode.Edit,DisplayMode.Disabled)
                              FocusedBorderColor: =Color.White
                              FocusedBorderThickness: =1
                              Height: =SaveGroupButton1_4.Height
                              Icon: =Icon.Save
                              PaddingBottom: =9
                              PaddingLeft: =9
                              PaddingRight: =9
                              PaddingTop: =9
                              TabIndex: =0
                              Tooltip: =SaveGroupButton1_4.Text
                              Width: =SaveGroupButton1_4.Height
                              X: =SaveGroupButton1_4.X
                              Y: =Parent.Height-Self.Height-15
                        - EditForm1_4:
                            Control: Form@2.4.4
                            Variant: Classic
                            Layout: Vertical
                            Properties:
                              AcceptsFocus: =true
                              BorderColor: =RGBA(0, 0, 0, 0)
                              BorderStyle: =BorderStyle.None
                              ContentLanguage: =Language()
                              DataSource: |-
                                =MyActivities
                                //pssChecklistsActivities
                              FocusedBorderThickness: =2
                              Height: =SaveGroupButton1_4.Y-Self.Y-15
                              Item: =First(Filter(MyActivities,ID=SelectedActivity))
                              SnapToColumns: =false
                              Width: =Parent.Width-2
                              Y: =150
                            Children:
                              - Comments_DataCard1:
                                  Control: TypedDataCard@1.0.7
                                  Variant: ClassicTextualEdit
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    DataField: ="Comments"
                                    Default: |+
                                      =Substitute(SActivityComments,"<br>",Char(10))
                                      //ThisItem.Comments
                                    DisplayName: =LookUp(colLanguage,Title="Comments").Wert
                                    MaxLength: =//DataSourceInfo([@pssChecklistsActivities]; DataSourceInfo.MaxLength; Comments)
                                    Required: =false
                                    Update: |+
                                      =SActivityComments
                                    Width: =Parent.Width
                                    X: =0
                                    Y: =55
                                  Children:
                                    - DataCardKey11:
                                        Control: Label@2.5.1
                                        MetadataKey: FieldName
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 1)
                                          Color: =RGBA(0, 18, 107, 1)
                                          Font: =Font.'Open Sans'
                                          Height: =48
                                          Size: =MyFontSize-1
                                          Text: =Parent.DisplayName
                                          Width: =Parent.Width - 60
                                          Wrap: =false
                                          X: =30
                                          Y: =10
                                    - DataCardValue9:
                                        Control: Classic/TextInput@2.3.2
                                        MetadataKey: FieldValue
                                        Properties:
                                          AccessibleLabel: ="Add final comments if required"
                                          BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                          Default: =Parent.Default
                                          DelayOutput: =true
                                          DisplayMode: =Parent.DisplayMode
                                          Fill: |+
                                            =//Ändern nur, wenn noch kein Wert vorhanden
                                            If(Self.DisplayMode=DisplayMode.Edit,
                                                RGBA(255, 255, 0, 1) //gelb
                                            ,
                                                RGBA(255, 255, 255, 1)
                                            )
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Height: =170
                                          HoverBorderColor: =RGBA(0, 18, 107, 1)
                                          HoverFill: =RGBA(186, 202, 226, 1)
                                          MaxLength: =Parent.MaxLength
                                          Mode: =TextMode.MultiLine
                                          OnChange: |-
                                            =Set(SActivityComments,
                                                Substitute(DataCardValue9.Text,Char(10),"<br>")
                                            )
                                          PaddingLeft: =5
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Size: =MyFontSize
                                          Tooltip: =Parent.DisplayName
                                          Width: =Parent.Width - 60
                                          X: =30
                                          Y: =DataCardKey11.Y + DataCardKey11.Height + 5
                                    - ErrorMessage12:
                                        Control: Label@2.5.1
                                        MetadataKey: ErrorMessage
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 1)
                                          Color: =RGBA(168, 0, 0, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =10
                                          Live: =Live.Assertive
                                          PaddingBottom: =0
                                          PaddingLeft: =0
                                          PaddingRight: =0
                                          PaddingTop: =0
                                          Size: =24
                                          Text: =Parent.Error
                                          Visible: =Parent.DisplayMode=DisplayMode.Edit
                                          Width: =Parent.Width - 60
                                          X: =30
                                          Y: =DataCardValue9.Y + DataCardValue9.Height
                                    - StarVisible12:
                                        Control: Label@2.5.1
                                        MetadataKey: FieldRequired
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 1)
                                          Color: =RGBA(0, 18, 107, 1)
                                          Font: =Font.'Open Sans'
                                          Height: =DataCardKey11.Height
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey11.Y
                              - DocumentStatus_DataCard1:
                                  Control: TypedDataCard@1.0.7
                                  Variant: ClassicTextualEdit
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    DataField: ="DocumentStatus"
                                    Default: =ThisItem.DocumentStatus
                                    DisplayName: =DataSourceInfo([@pssChecklistsActivities],DataSourceInfo.DisplayName,DocumentStatus)
                                    MaxLength: =DataSourceInfo([@pssChecklistsActivities], DataSourceInfo.MaxLength, DocumentStatus)
                                    Required: =false
                                    Update: =DataCardValue11.Text
                                    Visible: =false
                                    Width: =Parent.Width
                                    X: =0
                                    Y: =56
                                  Children:
                                    - DataCardKey13:
                                        Control: Label@2.5.1
                                        MetadataKey: FieldName
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 1)
                                          Color: =RGBA(0, 18, 107, 1)
                                          Font: =Font.'Open Sans'
                                          Height: =48
                                          Size: =MyFontSize-1
                                          Text: =Parent.DisplayName
                                          Width: =Parent.Width - 60
                                          Wrap: =false
                                          X: =30
                                          Y: =10
                                    - DataCardValue11:
                                        Control: Classic/TextInput@2.3.2
                                        MetadataKey: FieldValue
                                        Properties:
                                          AccessibleLabel: =" "
                                          BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                          Default: =Parent.Default
                                          DelayOutput: =true
                                          DisplayMode: =DisplayMode.View
                                          Fill: |+
                                            =//Ändern nur, wenn noch kein Wert vorhanden
                                            If(Self.DisplayMode=DisplayMode.Edit,
                                                RGBA(255, 255, 0, 1) //gelb
                                            ,
                                                RGBA(255, 255, 255, 1)
                                            )
                                          Font: =Font.'Open Sans'
                                          HoverBorderColor: =RGBA(0, 18, 107, 1)
                                          HoverFill: =RGBA(186, 202, 226, 1)
                                          MaxLength: =Parent.MaxLength
                                          PaddingLeft: =5
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Size: =MyFontSize
                                          Tooltip: =Parent.DisplayName
                                          Width: =Parent.Width - 60
                                          X: =30
                                          Y: =DataCardKey13.Y + DataCardKey13.Height + 5
                                    - ErrorMessage13:
                                        Control: Label@2.5.1
                                        MetadataKey: ErrorMessage
                                        Properties:
                                          AutoHeight: =true
                                          BorderColor: =RGBA(0, 0, 0, 1)
                                          Color: =RGBA(168, 0, 0, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Height: =10
                                          Live: =Live.Assertive
                                          PaddingBottom: =0
                                          PaddingLeft: =0
                                          PaddingRight: =0
                                          PaddingTop: =0
                                          Size: =24
                                          Text: =Parent.Error
                                          Visible: =Parent.DisplayMode=DisplayMode.Edit
                                          Width: =Parent.Width - 60
                                          X: =30
                                          Y: =DataCardValue11.Y + DataCardValue11.Height
                                    - StarVisible13:
                                        Control: Label@2.5.1
                                        MetadataKey: FieldRequired
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 1)
                                          Color: =RGBA(0, 18, 107, 1)
                                          Font: =Font.'Open Sans'
                                          Height: =DataCardKey13.Height
                                          Text: ="*"
                                          Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                          Width: =30
                                          Wrap: =false
                                          Y: =DataCardKey13.Y
                        - ActivityHeaderHtmlText1_4:
                            Control: HtmlViewer@2.1.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              DisabledBorderColor: =RGBA(0, 0, 0, 0)
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =150
                              HtmlText: |-
                                ="<b>"  
                                //&SActivityTitle
                                &SActivityChecklistText
                                &"<br />"

                                &If(Left(Language(),2)="de",
                                    Text(SActivityDate,"dddd, d. mmmm yyyy | hh:mm","de")
                                , //Else
                                    Text(SActivityDate,"dddd, mmmm d, yyyy | hh:mm","en")
                                )
                                &"<br />"

                                &SActivityUser
                                /*
                                &"<br />"
                                &"<br />"

                                &"<span style='font-size: smaller;'>"
                                &"KEY: " &SActivityKEY
                                &"</span>"
                                */
                              PaddingBottom: =15
                              PaddingLeft: =30
                              PaddingRight: =15
                              PaddingTop: =15
                              Size: =MyFontSize
                              Width: =Parent.Width
                              X: =
                              Y: =
            - FooterLabel1_4:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Right
                  BorderColor: =RGBA(0, 0, 0, 0)
                  BorderStyle: =BorderStyle.None
                  Color: =RGBA(255, 255, 255, 1)
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Lighter
                  Height: =50
                  PaddingLeft: =15
                  PaddingRight: =15
                  Size: =MyFontSize-3
                  Text: "=If(!IsBlank(FooterText),\r\n    FooterText,\r\n    \"v\"\r\n    &MyVersion\r\n    &\"|\"&MyDeviceType\r\n    &If(OnlineStatus=0,\"|Offline\",\"|Online\")\r\n    &\"|\"&MyLanguage\r\n    \r\n    //&\"|Mode:\"&EditForm1_15.Mode //(0=Edit;1=Add)\r\n    //&\"|EditEntry:\"&EditEntry\r\n    //&\"|SelectedChecklist\"&SelectedChecklist\r\n)\r\n"
                  Width: =Parent.Width
                  Wrap: =false
                  Y: =Parent.Height-Self.Height
      - ImageLoading1_4:
          Control: Image@2.2.3
          Properties:
            AccessibleLabel: =" "
            BorderColor: =RGBA(0, 18, 107, 1)
            DisplayMode: =DisplayMode.View
            Height: =150
            Image: =Loading_1
            ImagePosition: =ImagePosition.Fill
            TabIndex: =0
            Visible: =_ShowLoadingHint
            Width: =150
            X: =Parent.Width/2 - Self.Width/2
            Y: =Parent.Height/2 - Self.Height/2
      - ContainerSendData:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            DropShadow: =DropShadow.None
            Fill: =RGBA(241, 244, 249, 1)
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Visible: |+
              =_ShowSendingHint
            Width: =Parent.Width
            X: =
            Y: =
          Children:
            - SendDataHeader:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  BorderColor: =RGBA(0, 0, 0, 0)
                  BorderStyle: =BorderStyle.None
                  DropShadow: =DropShadow.None
                  Fill: =RGBA(9, 33, 98, 1)
                  FillPortions: =0
                  Height: =88
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: |-
                    =Parent.Width
                    -Parent.PaddingLeft
                    -Parent.PaddingRight
                  X: =
                  Y: =
                Children:
                  - SendDataHeaderLabel:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(255, 255, 255, 1)
                        ContentLanguage: =Language()
                        Font: =Font.'Open Sans'
                        Height: =Parent.Height
                        OnSelect: =
                        PaddingLeft: =10
                        PaddingRight: =10
                        Size: =MyFontSize+2
                        Text: |-
                          ="Sending data to SharePoint"
                          //LookUp(MyUVVSettings;Title="Sende Daten an SharePoint").Wert
                        Tooltip: =Self.Text
                        Width: =Parent.Width
                        Wrap: =false
                        X: =
                        Y: =
            - SendDataContent:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  BorderColor: =RGBA(0, 0, 0, 0)
                  BorderStyle: =BorderStyle.None
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =Parent.Height-SendDataHeader.Height
                  PaddingBottom: =10
                  PaddingLeft: =10
                  PaddingRight: =10
                  PaddingTop: =10
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: |-
                    =Parent.Width
                    -Parent.PaddingLeft
                    -Parent.PaddingRight
                  X: =
                  Y: =
                Children:
                  - SendDataContentHtml:
                      Control: HtmlViewer@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Color: =RGBA(255, 255, 0, 1)
                        ContentLanguage: =Language()
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        Height: =SendDataContent.Height-Self.Y*2
                        HtmlText: =SendDataText
                        OnSelect: =
                        PaddingBottom: =15
                        PaddingLeft: =15
                        PaddingRight: =15
                        PaddingTop: =15
                        Size: =MyFontSize+2
                        Tooltip: =
                        Width: =Parent.Width-Self.X*2
                        X: =15
                        Y: =15
      - Timer1_4:
          Control: Timer@2.1.0
          Properties:
            AutoStart: =true
            BorderColor: =//ColorFade(Self.Fill; -15%)
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =
            DisabledColor: =
            DisabledFill: =
            Duration: =500
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.'Open Sans'
            FontWeight: =FontWeight.Lighter
            Height: =26
            HoverBorderColor: =
            HoverColor: =
            HoverFill: =
            OnTimerEnd: |+
              =If(Connection.Connected,
                  Set (OnlineStatus, 1)
              ,// Else    
                  Set (OnlineStatus, 0)
              );
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Repeat: =true
            Size: =11
            Text: =//Text(Time(0; 0; Self.Value/1000); "hh:mm:ss")
            Visible: =false
            Width: =98
            X: =476
            Y: =928
